-- LocalScript inside StarterPlayerScripts

-- Services
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

-- Default key
local defaultKey = Enum.KeyCode.U
player:SetAttribute("RejoinKey", defaultKey)

-- Prevent duplicate GUIs
if player:WaitForChild("PlayerGui"):FindFirstChild("RejoinGUI") then return end

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RejoinGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Main Frame (smaller)
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0.15, 0, 0.18, 0)  -- smaller width and height
mainFrame.Position = UDim2.new(0.8, 0, 0.5, -0.09*workspace.CurrentCamera.ViewportSize.Y) -- right-middle
mainFrame.AnchorPoint = Vector2.new(0, 0.5)
mainFrame.BackgroundColor3 = Color3.fromRGB(10, 15, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

-- Gradient
local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(5, 5, 10)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 25, 80))
}
gradient.Rotation = 270
gradient.Parent = mainFrame

-- Rounded corners & outline
local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 12)
frameCorner.Parent = mainFrame

local frameStroke = Instance.new("UIStroke")
frameStroke.Thickness = 2
frameStroke.Color = Color3.fromRGB(255, 255, 255)
frameStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
frameStroke.Parent = mainFrame

-- Layout using UIListLayout for automatic spacing
local layout = Instance.new("UIListLayout")
layout.Parent = mainFrame
layout.FillDirection = Enum.FillDirection.Vertical
layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
layout.VerticalAlignment = Enum.VerticalAlignment.Top
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0, 6) -- smaller spacing
layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    mainFrame.Size = UDim2.new(mainFrame.Size.X.Scale, 0, 0, layout.AbsoluteContentSize.Y + 12)
end)

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -12, 0, 25) -- slightly smaller
title.BackgroundTransparency = 1
title.Text = "Server Rejoiner"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.TextYAlignment = Enum.TextYAlignment.Center
title.Parent = mainFrame

-- Subtitle
local subtitle = Instance.new("TextLabel")
subtitle.Size = UDim2.new(1, -12, 0, 18)
subtitle.BackgroundTransparency = 1
subtitle.Text = "Made by SyN"
subtitle.TextColor3 = Color3.fromRGB(180, 200, 255)
subtitle.Font = Enum.Font.Gotham
subtitle.TextSize = 12
subtitle.TextYAlignment = Enum.TextYAlignment.Center
subtitle.Parent = mainFrame

-- Keybind Label
local keyLabel = Instance.new("TextLabel")
keyLabel.Size = UDim2.new(1, -12, 0, 18)
keyLabel.BackgroundTransparency = 1
keyLabel.TextColor3 = Color3.fromRGB(180, 200, 255)
keyLabel.Font = Enum.Font.Gotham
keyLabel.TextSize = 12
keyLabel.Text = "Keybind: "..player:GetAttribute("RejoinKey").Name
keyLabel.TextYAlignment = Enum.TextYAlignment.Center
keyLabel.Parent = mainFrame

-- Rejoin Button
local button = Instance.new("TextButton")
button.Size = UDim2.new(0.8, 0, 0, 35)
button.BackgroundColor3 = Color3.fromRGB(20, 40, 100)
button.TextColor3 = Color3.fromRGB(255, 255, 255)
button.Font = Enum.Font.GothamBold
button.TextSize = 18
button.Text = "Rejoin"
button.Parent = mainFrame

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = button

local stroke = Instance.new("UIStroke")
stroke.Thickness = 2
stroke.Color = Color3.fromRGB(255, 255, 255)
stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
stroke.Parent = button

-- Button hover animation
button.MouseEnter:Connect(function()
    button:TweenSize(UDim2.new(0.85, 0, 0, 38), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.15, true)
    button.BackgroundColor3 = Color3.fromRGB(40, 70, 180)
end)

button.MouseLeave:Connect(function()
    button:TweenSize(UDim2.new(0.8, 0, 0, 35), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.15, true)
    button.BackgroundColor3 = Color3.fromRGB(20, 40, 100)
end)

-- Rejoin function
local function rejoinServer()
    button.Text = "Rejoining..."
    button.BackgroundColor3 = Color3.fromRGB(10, 30, 80)
    wait(0.4)
    TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, player)
end

-- Button click
button.MouseButton1Click:Connect(rejoinServer)

-- Key press detection
UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == player:GetAttribute("RejoinKey") then
        rejoinServer()
    end
end)

-- Dynamic keybind label update
player:GetAttributeChangedSignal("RejoinKey"):Connect(function()
    keyLabel.Text = "Keybind: "..player:GetAttribute("RejoinKey").Name
end)
